<Window x:Class="DesignSheet.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:local="clr-namespace:DesignSheet"
        Title="Workshop Tracker"
        Height="650"
        Width="1350"
        WindowStyle="None"
        ResizeMode="CanResize"
        Closing="MainWindow_Closing">

    <Window.Resources>

        <!-- Status options -->
        <x:Array x:Key="StatusOptions" Type="{x:Type sys:String}">
            <sys:String>Quote</sys:String>
            <sys:String>Assembly</sys:String>
            <sys:String>Balancing</sys:String>
            <sys:String>Booked in</sys:String>
            <sys:String>Drive Shop</sys:String>
            <sys:String>ON HOLD</sys:String>
            <sys:String>Completed</sys:String>
            <sys:String>Paint shop</sys:String>
            <sys:String>Picking</sys:String>
            <sys:String>Quoting</sys:String>
            <sys:String>Picked up</sys:String>
            <sys:String>Cancelled</sys:String>
        </x:Array>

        <!-- Day-of-week options -->
        <x:Array x:Key="DayDueOptions" Type="{x:Type sys:String}">
            <sys:String>Monday</sys:String>
            <sys:String>Tuesday</sys:String>
            <sys:String>Wednesday</sys:String>
            <sys:String>Thursday</sys:String>
            <sys:String>Friday</sys:String>
            <sys:String>Saturday</sys:String>
            <sys:String>Sunday</sys:String>
        </x:Array>

        <!-- Priority options -->
        <x:Array x:Key="PriorityOptions" Type="{x:Type sys:String}">
            <sys:String>Y</sys:String>
            <sys:String>N</sys:String>
        </x:Array>

        <!-- Generic Yes/No -->
        <x:Array x:Key="YesNoOptions" Type="{x:Type sys:String}">
            <sys:String>Y</sys:String>
            <sys:String>N</sys:String>
        </x:Array>

        <!-- OE options -->
        <x:Array x:Key="OEOptions" Type="{x:Type sys:String}">
            <sys:String>Y</sys:String>
            <sys:String>N</sys:String>
            <sys:String>Z</sys:String>
            <sys:String>A/L</sys:String>
        </x:Array>

        <!-- ShaftType options -->
        <x:Array x:Key="ShaftTypeOptions" Type="{x:Type sys:String}">
            <sys:String>Domestic</sys:String>
            <sys:String>Industrial</sys:String>
        </x:Array>

        <!-- STATUS cell style -->
        <Style x:Key="StatusCellStyle" TargetType="DataGridCell">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>

            <Style.Triggers>
                <DataTrigger Binding="{Binding Status}" Value="Quote">
                    <Setter Property="Background" Value="#2563eb"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Assembly">
                    <Setter Property="Background" Value="#8b5a2b"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Balancing">
                    <Setter Property="Background" Value="#7c3aed"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Booked in">
                    <Setter Property="Background" Value="#9ca3af"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Drive Shop">
                    <Setter Property="Background" Value="#f9a8d4"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="ON HOLD">
                    <Setter Property="Background" Value="#ef4444"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Completed">
                    <Setter Property="Background" Value="#facc15"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Paint shop">
                    <Setter Property="Background" Value="#fb923c"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Picking">
                    <Setter Property="Background" Value="#e9d5ff"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Quoting">
                    <Setter Property="Background" Value="#0d9488"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Picked up">
                    <Setter Property="Background" Value="#22c55e"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Status}" Value="Cancelled">
                    <Setter Property="Background" Value="#b91c1c"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- PRIORITY cell style -->
        <Style x:Key="PriorityCellStyle" TargetType="DataGridCell">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Priority}" Value="Y">
                    <Setter Property="Background" Value="#22c55e"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Priority}" Value="N">
                    <Setter Property="Background" Value="#ef4444"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- RETAIL cell style -->
        <Style x:Key="RetailCellStyle" TargetType="DataGridCell">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Retail}" Value="Y">
                    <Setter Property="Background" Value="#fb923c"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Retail}" Value="N">
                    <Setter Property="Background" Value="#facc15"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- OE cell style -->
        <Style x:Key="OECellStyle" TargetType="DataGridCell">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding OE}" Value="Y">
                    <Setter Property="Background" Value="#fb923c"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding OE}" Value="N">
                    <Setter Property="Background" Value="#facc15"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding OE}" Value="Z">
                    <Setter Property="Background" Value="#ef4444"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding OE}" Value="A/L">
                    <Setter Property="Background" Value="#bfdbfe"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Customer cell style (Industrial) -->
        <Style x:Key="CustomerCellStyle" TargetType="DataGridCell">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding ShaftType}" Value="Industrial">
                    <Setter Property="Background" Value="#f4e2c5"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <local:DateDueToBrushConverter x:Key="DateDueToBrushConverter"/>

        <Style x:Key="DateDueCellStyle" TargetType="DataGridCell">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Background"
                    Value="{Binding DateDue, Converter={StaticResource DateDueToBrushConverter}}"/>
        </Style>

        <!-- Row style -->
        <Style x:Key="ModernRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>

            <Style.Triggers>
                <Trigger Property="AlternationIndex" Value="1">
                    <Setter Property="Background" Value="#f9fafb"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#e5f3f1"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#d1fae5"/>
                    <Setter Property="Foreground" Value="Black"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Flat button -->
        <Style x:Key="FlatButton" TargetType="Button">
            <Setter Property="Background" Value="#0f766e"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Search box -->
        <Style x:Key="SearchBox" TargetType="TextBox">
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="0,0,20,0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="BorderBrush" Value="#d1d5db"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="16">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="4,0,4,0"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                <GradientStop Color="#f3f4f6" Offset="0"/>
                <GradientStop Color="#e5e7eb" Offset="1"/>
            </LinearGradientBrush>
        </Grid.Background>

        <Border Margin="0"
                CornerRadius="0"
                Background="White"
                SnapsToDevicePixels="True">
            <Border.Effect>
                <DropShadowEffect Color="#000000"
                                  Opacity="0.0"
                                  ShadowDepth="0"
                                  BlurRadius="0"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="48"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Title bar -->
                <Border Grid.Row="0"
                        Background="#0f766e"
                        CornerRadius="0"
                        MouseLeftButtonDown="TitleBar_MouseDown">
                    <DockPanel LastChildFill="False" Margin="12,0">
                        <StackPanel Orientation="Horizontal"
                                    VerticalAlignment="Center">
                            <TextBlock Text="Workshop Tracker"
                                       VerticalAlignment="Center"
                                       Foreground="White"
                                       FontWeight="SemiBold"
                                       FontSize="16"
                                       Margin="0,0,8,0"/>
                            <TextBlock Text="• Workshop job board"
                                       VerticalAlignment="Center"
                                       Foreground="#d1fae5"
                                       FontSize="12"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal"
                                    DockPanel.Dock="Right"
                                    HorizontalAlignment="Right">
                            <Button Width="30" Height="24" Margin="4,8,0,8"
                                    Click="MinimizeButton_Click"
                                    Background="Transparent"
                                    BorderBrush="Transparent"
                                    Foreground="White"
                                    FontSize="14">_</Button>
                            <Button Width="30" Height="24" Margin="4,8,0,8"
                                    Click="MaximizeRestoreButton_Click"
                                    Background="Transparent"
                                    BorderBrush="Transparent"
                                    Foreground="White"
                                    FontSize="14">☐</Button>
                            <Button Width="30" Height="24" Margin="4,8,0,8"
                                    Click="CloseButton_Click"
                                    Background="Transparent"
                                    BorderBrush="Transparent"
                                    Foreground="White"
                                    FontSize="14">X</Button>
                        </StackPanel>
                    </DockPanel>
                </Border>

                <!-- Main content -->
                <DockPanel Grid.Row="1" Margin="16,12,16,16">

                    <!-- Top bar -->
                    <StackPanel DockPanel.Dock="Top"
                                Orientation="Horizontal"
                                Margin="0,0,0,12"
                                VerticalAlignment="Center">
                        <TextBlock Text="Search"
                                   VerticalAlignment="Center"
                                   Margin="0,0,6,0"
                                   Foreground="#4b5563"
                                   FontSize="13"/>
                        <TextBox x:Name="SearchTextBox"
                                 Width="220"
                                 Style="{StaticResource SearchBox}"
                                 TextChanged="SearchTextBox_TextChanged"/>

                        <Button Content="Reload"
                                Width="90"
                                Style="{StaticResource FlatButton}"
                                Click="Reload_Click"/>
                        <Button Content="Add Row"
                                Width="90"
                                Style="{StaticResource FlatButton}"
                                Click="AddRow_Click"/>
                        <Button Content="Delete Row"
                                Width="110"
                                Style="{StaticResource FlatButton}"
                                Click="DeleteRow_Click"/>
                        <Button Content="Save Changes"
                                Width="130"
                                Style="{StaticResource FlatButton}"
                                Click="Save_Click"/>
                    </StackPanel>

                    <!-- Tabs for Active / Finished -->
                    <TabControl x:Name="MainTabControl">
                        <!-- Active tab -->
                        <TabItem Header="Active">
                            <Border CornerRadius="8"
                                    BorderBrush="#e5e7eb"
                                    BorderThickness="1"
                                    Margin="0,8,0,0">
                                <DataGrid x:Name="DesignGrid"
                                          AutoGenerateColumns="False"
                                          CanUserAddRows="False"
                                          IsReadOnly="False"
                                          ItemsSource="{Binding ActiveDesigns}"
                                          CanUserSortColumns="True"
                                          GridLinesVisibility="None"
                                          RowHeight="34"
                                          AllowDrop="True"
                                          AlternationCount="2"
                                          RowStyle="{StaticResource ModernRowStyle}"
                                          PreviewMouseLeftButtonDown="DesignGrid_PreviewMouseLeftButtonDown"
                                          MouseMove="DesignGrid_MouseMove"
                                          Drop="DesignGrid_Drop"
                                          CellEditEnding="DesignGrid_CellEditEnding"
                                          Sorting="DesignGrid_Sorting"
                                          HeadersVisibility="Column"
                                          ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                          ScrollViewer.VerticalScrollBarVisibility="Auto">

                                    <DataGrid.CellStyle>
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            <Setter Property="SnapsToDevicePixels" Value="True"/>
                                        </Style>
                                    </DataGrid.CellStyle>

                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#0f766e"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="BorderBrush" Value="#0b4f49"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            <Setter Property="Padding" Value="4,6"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>

                                    <DataGrid.Columns>

                                        <!-- Drag handle -->
                                        <DataGridTemplateColumn Header="" Width="40" IsReadOnly="True">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="⋮⋮⋮"
                                                               FontSize="18"
                                                               Foreground="#9ca3af"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>

                                        <!-- Retail -->
                                        <DataGridTemplateColumn Header="Retail"
                                                                Width="*"
                                                                SortMemberPath="Retail">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Retail}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource YesNoOptions}"
                                                              SelectedItem="{Binding Retail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource RetailCellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <!-- OE -->
                                        <DataGridTemplateColumn Header="OE"
                                                                Width="*"
                                                                SortMemberPath="OE">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding OE}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource OEOptions}"
                                                              SelectedItem="{Binding OE, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource OECellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <!-- CUSTOMER -->
                                        <DataGridTextColumn Header="CUSTOMER"
                                                            Binding="{Binding Customer, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="Customer">
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource CustomerCellStyle}"/>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <DataGridTextColumn Header="SERIAL#"
                                                            Binding="{Binding SerialNumber, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="*"
                                                            SortMemberPath="SerialNumber"/>

                                        <!-- DAY DUE -->
                                        <DataGridTemplateColumn Header="DAY DUE"
                                                                Width="*"
                                                                SortMemberPath="DayDue">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DayDue}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource DayDueOptions}"
                                                              SelectedItem="{Binding DayDue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>

                                        <!-- Date due -->
                                        <DataGridTextColumn Header="Date due"
                                                            SortMemberPath="DateDue">
                                            <DataGridTextColumn.Binding>
                                                <Binding Path="DateDue"
                                                         StringFormat="{}{0:dd/MM/yyyy}"
                                                         UpdateSourceTrigger="PropertyChanged"/>
                                            </DataGridTextColumn.Binding>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource DateDueCellStyle}"/>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <!-- Status -->
                                        <DataGridTemplateColumn Header="status"
                                                                Width="*"
                                                                SortMemberPath="Status">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Status}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource StatusOptions}"
                                                              SelectedItem="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource StatusCellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <DataGridTextColumn Header="qty"
                                                            Binding="{Binding Qty, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="*"
                                                            SortMemberPath="Qty"/>

                                        <DataGridTextColumn Header="What is it"
                                                            Binding="{Binding WhatIsIt, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="WhatIsIt"/>

                                        <DataGridTextColumn Header="PO#"
                                                            Binding="{Binding PO, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="*"
                                                            SortMemberPath="PO"/>

                                        <DataGridTextColumn Header="WHAT ARE WE DOING"
                                                            Binding="{Binding WhatAreWeDoing, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="WhatAreWeDoing"/>

                                        <DataGridTextColumn Header="PARTS"
                                                            Binding="{Binding Parts, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="Parts"/>

                                        <!-- Shaft type -->
                                        <DataGridTemplateColumn Header="SHAFT TYPE"
                                                                Width="*"
                                                                SortMemberPath="ShaftType">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding ShaftType}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource ShaftTypeOptions}"
                                                              SelectedItem="{Binding ShaftType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>

                                        <!-- Priority -->
                                        <DataGridTemplateColumn Header="PRIORITY"
                                                                Width="*"
                                                                SortMemberPath="Priority">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Priority}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource PriorityOptions}"
                                                              SelectedItem="{Binding Priority, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource PriorityCellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <!-- Last user -->
                                        <DataGridTextColumn Header="LAST USER"
                                                            Binding="{Binding LastUser}"
                                                            Width="*"
                                                            IsReadOnly="True"
                                                            SortMemberPath="LastUser"/>

                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </TabItem>

                        <!-- Finished tab -->
                        <TabItem Header="Finished">
                            <Border CornerRadius="8"
                                    BorderBrush="#e5e7eb"
                                    BorderThickness="1"
                                    Margin="0,8,0,0">
                                <DataGrid x:Name="FinishedGrid"
                                          AutoGenerateColumns="False"
                                          CanUserAddRows="False"
                                          IsReadOnly="False"
                                          ItemsSource="{Binding FinishedDesigns}"
                                          CanUserSortColumns="True"
                                          GridLinesVisibility="None"
                                          RowHeight="34"
                                          AlternationCount="2"
                                          RowStyle="{StaticResource ModernRowStyle}"
                                          CellEditEnding="DesignGrid_CellEditEnding"
                                          Sorting="DesignGrid_Sorting"
                                          HeadersVisibility="Column"
                                          ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                          ScrollViewer.VerticalScrollBarVisibility="Auto">

                                    <DataGrid.CellStyle>
                                        <Style TargetType="DataGridCell">
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            <Setter Property="SnapsToDevicePixels" Value="True"/>
                                        </Style>
                                    </DataGrid.CellStyle>

                                    <DataGrid.ColumnHeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="#0f766e"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                            <Setter Property="BorderBrush" Value="#0b4f49"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                            <Setter Property="Padding" Value="4,6"/>
                                        </Style>
                                    </DataGrid.ColumnHeaderStyle>

                                    <!-- Same columns as Active (no drag handle) -->
                                    <DataGrid.Columns>

                                        <!-- Retail -->
                                        <DataGridTemplateColumn Header="Retail"
                                                                Width="*"
                                                                SortMemberPath="Retail">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Retail}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource YesNoOptions}"
                                                              SelectedItem="{Binding Retail, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource RetailCellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <!-- OE -->
                                        <DataGridTemplateColumn Header="OE"
                                                                Width="*"
                                                                SortMemberPath="OE">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding OE}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource OEOptions}"
                                                              SelectedItem="{Binding OE, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource OECellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <!-- CUSTOMER -->
                                        <DataGridTextColumn Header="CUSTOMER"
                                                            Binding="{Binding Customer, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="Customer">
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource CustomerCellStyle}"/>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <DataGridTextColumn Header="SERIAL#"
                                                            Binding="{Binding SerialNumber, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="*"
                                                            SortMemberPath="SerialNumber"/>

                                        <!-- DAY DUE -->
                                        <DataGridTemplateColumn Header="DAY DUE"
                                                                Width="*"
                                                                SortMemberPath="DayDue">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding DayDue}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource DayDueOptions}"
                                                              SelectedItem="{Binding DayDue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>

                                        <!-- Date due -->
                                        <DataGridTextColumn Header="Date due"
                                                            SortMemberPath="DateDue">
                                            <DataGridTextColumn.Binding>
                                                <Binding Path="DateDue"
                                                         StringFormat="{}{0:dd/MM/yyyy}"
                                                         UpdateSourceTrigger="PropertyChanged"/>
                                            </DataGridTextColumn.Binding>
                                            <DataGridTextColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource DateDueCellStyle}"/>
                                            </DataGridTextColumn.CellStyle>
                                        </DataGridTextColumn>

                                        <!-- Status -->
                                        <DataGridTemplateColumn Header="status"
                                                                Width="*"
                                                                SortMemberPath="Status">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Status}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource StatusOptions}"
                                                              SelectedItem="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource StatusCellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <DataGridTextColumn Header="qty"
                                                            Binding="{Binding Qty, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="*"
                                                            SortMemberPath="Qty"/>

                                        <DataGridTextColumn Header="What is it"
                                                            Binding="{Binding WhatIsIt, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="WhatIsIt"/>

                                        <DataGridTextColumn Header="PO#"
                                                            Binding="{Binding PO, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="*"
                                                            SortMemberPath="PO"/>

                                        <DataGridTextColumn Header="WHAT ARE WE DOING"
                                                            Binding="{Binding WhatAreWeDoing, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="WhatAreWeDoing"/>

                                        <DataGridTextColumn Header="PARTS"
                                                            Binding="{Binding Parts, UpdateSourceTrigger=PropertyChanged}"
                                                            Width="2*"
                                                            SortMemberPath="Parts"/>

                                        <!-- Shaft type -->
                                        <DataGridTemplateColumn Header="SHAFT TYPE"
                                                                Width="*"
                                                                SortMemberPath="ShaftType">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding ShaftType}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource ShaftTypeOptions}"
                                                              SelectedItem="{Binding ShaftType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                        </DataGridTemplateColumn>

                                        <!-- Priority -->
                                        <DataGridTemplateColumn Header="PRIORITY"
                                                                Width="*"
                                                                SortMemberPath="Priority">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding Priority}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                            <DataGridTemplateColumn.CellEditingTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{StaticResource PriorityOptions}"
                                                              SelectedItem="{Binding Priority, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                              HorizontalContentAlignment="Center"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellEditingTemplate>
                                            <DataGridTemplateColumn.CellStyle>
                                                <Style TargetType="DataGridCell"
                                                       BasedOn="{StaticResource PriorityCellStyle}"/>
                                            </DataGridTemplateColumn.CellStyle>
                                        </DataGridTemplateColumn>

                                        <!-- Last user -->
                                        <DataGridTextColumn Header="LAST USER"
                                                            Binding="{Binding LastUser}"
                                                            Width="*"
                                                            IsReadOnly="True"
                                                            SortMemberPath="LastUser"/>

                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </TabItem>

                    </TabControl>
                </DockPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
